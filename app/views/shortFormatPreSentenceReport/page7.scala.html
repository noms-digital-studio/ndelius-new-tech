@import data._
@import helper._
@import hiddenInputs._
@import play.Environment
@import data.viewModel.PageStatus
@import helpers.CallHelper.relative
@import org.webjars.play.WebJarsUtil

@(reportForm: Form[ShortFormatPreSentenceReportData], encrypter: String => String)(implicit pageStatuses: Map[Int, PageStatus], webJarsUtil: WebJarsUtil, environment: Environment)

@implicitField = @{ FieldConstructor(govukElements.f) }

@traumaGuidance = {
    <p>Trauma can affect an offender's ability to engage and make decisions. Detail the offender's experience of trauma. How has it affected their offending? Has it affected their engagement with rehabilitative interventions?</p>
}

@caringResponsibilitiesGuidance = {
    <p>Detail the offenderâ€™s current and past caring responsibilities. Take account of caring for both children and adults. How have those responsibilities affected their offending? Have they affected their engagement with rehabilitative interventions?</p>
}
@main("Offender assessment - Short Format Pre Sentence Report") {

    <h1 class="heading-xlarge">Offender assessment</h1>

    <div class="grid-row">
        <div class="column-one-third">

        @navigation(7)

        </div>
        <div class="column-two-thirds">
            @govukGlobalErrors(reportForm)
            @if(!reportForm.errors("issueAccommodation").isEmpty) {
                <div class="error-summary" role="alert" aria-labelledby="error-summary-heading" tabindex="-1">

                    <h2 class="heading-medium error-summary-heading" id="error-summary-heading">
                        You need to select one of the underlying issues
                    </h2>

                    <p>
                        Please select underlying issues from the options below.
                    </p>
                    <p>
                        If the relevant option is not available select other.
                    </p>
                </div>
            }


            <h2 class="lede no-margin-top margin-bottom medium">Select the underlying issues that are relevant as motivators or drivers for the main offence</h2>

            <div class="notice">
                <i class="icon icon-important">
                    <span class="visually-hidden">Warning</span>
                </i>
                <strong class="bold-small">
                    By not selecting an issue you are indicating it is not relevant
                </strong>
            </div>

            <p>&nbsp;</p>

            @helper.form(action = relative(routes.ShortFormatPreSentenceReportController.wizardPost()), 'novalidate -> "") {
                @CSRF.formField

                @commonFields(reportForm, encrypter)
                @page2Fields(reportForm, encrypter)
                @page3Fields(reportForm, encrypter)
                @page4Fields(reportForm)
                @page5Fields(reportForm)
                @page6Fields(reportForm)

                <div class="form-group@if(reportForm.allErrors.stream.anyMatch(_.key.startsWith("issue"))) { form-group-error}">
                @checkboxDetailsField(reportForm, "issueAccommodation", "Accommodation", "Provide a brief assessment for accommodation", Some("Select underlying issues from the options below"))
                @checkboxDetailsField(reportForm, "issueEmployment", "Employment, training and education", "Provide a brief assessment for employment", Some(""))
                @checkboxDetailsField(reportForm, "issueFinance", "Finance", "Provide a brief assessment for finance", Some(""))
                @checkboxDetailsField(reportForm, "issueRelationships", "Relationships", "Provide a brief assessment for relationships", Some(""))
                @checkboxDetailsField(reportForm, "issueSubstanceMisuse", "Substance misuse", "Provide a brief assessment for substance misuse", Some(""))
                @checkboxDetailsField(reportForm, "issueHealth", "Physical & mental health", "Provide a brief assessment for physical & mental health", Some(""))
                @checkboxDetailsField(reportForm, "issueBehaviour", "Thinking & behaviour", "Provide a brief assessment for behaviour", Some(""))
                @checkboxDetailsField(reportForm, "issueOther", "Other (Please specify below)", "Provide a brief assessment of other issues", Some(""))
                </div>

                <hr />

                <div class="form-group">
                    <fieldset>
                        <legend class="margin-bottom medium">
                            <span class="form-label-bold">Is there evidence of the offender experiencing trauma?</span>
                        </legend>

                        @inputRadioGroup(
                            reportForm("experienceTrauma"),
                            options(
                                "yes" -> "Yes",
                                "no" -> "No"
                            ),
                            Symbol("data-target") -> "experienceTrauma-details",
                            Symbol("data-ignore") -> "no"
                        )
                    </fieldset>

                    <div class="panel panel-border-narrow js-hidden" id="experienceTrauma-details">
                    @textarea(reportForm("experienceTraumaDetails"), '_label -> "Experience of trauma", '_hint -> traumaGuidance, 'class -> "wide")
                    </div>
                </div>


                <hr />

                <div class="form-group">
                    <fieldset>
                        <legend class="margin-bottom medium">
                            <span class="form-label-bold">Does the offender have caring responsibilities for children or adults, or have they ever had caring responsibilities for children or adults?</span>
                        </legend>

                        @inputRadioGroup(
                            reportForm("caringResponsibilities"),
                            options(
                                "yes" -> "Yes",
                                "no" -> "No"
                            ),
                            Symbol("data-target") -> "caringResponsibilities-details",
                            Symbol("data-ignore") -> "no"
                        )
                    </fieldset>

                    <div class="panel panel-border-narrow js-hidden" id="caringResponsibilities-details">
                    @textarea(reportForm("caringResponsibilitiesDetails"), '_label -> "Caring responsibilities", '_hint -> caringResponsibilitiesGuidance, 'class -> "wide")
                    </div>
                </div>



                @page8Fields(reportForm)
                @page9Fields(reportForm)
                @page11Fields(reportForm, encrypter)

                @footer(7, reportForm, encrypter)
            }

        </div>
    </div>
}
